# AI Agent Instructions for Marriott Connect

## Project Overview

This is a **Laravel 12** web application with **Livewire 4** and **Tailwind CSS**, featuring user authentication and profile management. The stack uses Vite for asset bundling and Blade templating for server-side views.

## Architecture & Key Components

### Technology Stack

- **Backend**: Laravel 12, PHP 8.2+, Eloquent ORM
- **Frontend**: Blade templates, Alpine.js, Tailwind CSS v3
- **Build Tool**: Vite 7 with laravel-vite-plugin
- **Real-time**: Livewire 4 for interactive components
- **Testing**: PHPUnit 11.5+ (Unit & Feature tests)
- **Database**: Configured for SQLite (testing), configurable for production

### Directory Structure

```
app/
  Http/Controllers/        # Request handlers (ProfileController, Auth controllers)
  Http/Requests/          # FormRequest validation classes
  Models/                 # Eloquent models (User.php)
  Providers/              # Service providers (AppServiceProvider.php)
  View/Components/        # Blade components (reusable UI)

resources/
  views/                  # Blade templates (.blade.php)
    auth/                 # Authentication forms (login, register, etc.)
    layouts/              # Main layout wrappers (app-layout)
    profile/              # Profile-related views
    components/           # Reusable Blade components
  css/app.css            # Tailwind CSS entry point
  js/                    # Frontend JavaScript

routes/
  web.php                 # Web routes (GET /dashboard, /profile)
  auth.php                # Authentication routes (generated by Laravel Breeze)

tests/
  Feature/                # HTTP integration tests
  Unit/                   # Unit tests for business logic

database/
  migrations/             # Schema changes (versioned files)
  factories/              # Model factories for testing (UserFactory.php)
  seeders/                # Database seeders
```

### Authentication Model

- Uses **Laravel Breeze** (provided auth scaffolding)
- Sessions stored in-memory (testing) or file-based (production)
- Routes protected with `auth` and `verified` middleware
- User model uses `Authenticatable` trait with password hashing

## Development Workflow

### Setup & Installation

```bash
composer run setup  # Installs dependencies, generates key, runs migrations, builds assets
```

### Development Server

```bash
composer run dev  # Runs concurrent processes: Laravel server, queue listener, logs, Vite dev server
```

### Build & Deployment

```bash
npm run build      # Vite builds production assets (public/build/)
php artisan migrate  # Apply pending migrations to database
```

### Testing

```bash
composer test      # Runs PHPUnit (clears config first)
```

Tests use `RefreshDatabase` trait to reset database state between tests.

## Project-Specific Patterns

### Controllers

- Controllers return views with `view('view.name', $data)` syntax
- Use type-hinting for request objects: `ProfileUpdateRequest` extends `FormRequest`
- Authentication check via `$request->user()` (returns authenticated User)
- Redirects use `Redirect::route('name')` with `with('status', 'key')` for flash messages

### Blade Components

- Custom components defined in `resources/views/components/`
- Usage: `<x-component-name />` with slot syntax support
- Main layout: `<x-app-layout>` wraps authenticated pages (see dashboard.blade.php)

### CSS & Styling

- **Tailwind CSS** configured with Laravel views in `tailwind.config.js` content paths
- Custom fonts via `@tailwindcss/forms` plugin
- Figtree font extends default sans-serif family
- Responsive classes: `sm:`, `lg:` prefixes standard

### Database

- Migrations versioned with timestamps (e.g., `0001_01_01_000000_create_users_table.php`)
- Models in `app/Models/` use `HasFactory` trait for testing
- User model casts: `email_verified_at` → datetime, `password` → hashed
- Fillable attributes: name, email, password

### Testing Patterns

- Tests use `RefreshDatabase` middleware to reset DB per test
- Authentication in tests: `$this->actingAs($user)->get('/profile')`
- Factory usage: `User::factory()->create()` generates test data
- Feature tests validate HTTP responses: `->assertOk()`, `->assertRedirect()`

## Critical Workflows

### Adding a New Feature

1. Create migration: `php artisan make:migration create_table_name`
2. Define model in `app/Models/` with `HasFactory`
3. Create controller: `php artisan make:controller FeatureController`
4. Add routes to `routes/web.php` (or `routes/auth.php` if protected)
5. Create Blade views in `resources/views/feature/`
6. Write feature tests in `tests/Feature/`

### Modifying User Profile

- Update `app/Models/User.php` with new fillable fields
- Create migration for schema changes
- Create `ProfileUpdateRequest` in `app/Http/Requests/` for validation
- Update `resources/views/profile/edit.blade.php` form
- Update test in `tests/Feature/ProfileTest.php`

### Running Migrations

- Always use `php artisan migrate` (not raw SQL)
- Test migrations: `php artisan migrate:refresh` (destructive, resets DB)
- Production: `php artisan migrate --force` (requires confirmation bypass)

## Important Notes for AI Agents

- **No registration by default**: User registration is commented out in `routes/auth.php`
- **Session authentication**: App uses session-based auth, not API tokens
- **Blade syntax**: Double curly braces `{{ }}` for escaping; `{!! !!}` for raw HTML
- **Middleware**: Protected routes use `['auth', 'verified']` middleware chain
- **Config files**: Environment variables in `.env` (e.g., `DB_CONNECTION`, `MAIL_MAILER`)
- **Service container**: Dependency injection via constructor type-hinting
- **Artisan commands**: Many shortcuts available (`make:controller`, `migrate`, `tinker`, etc.)
